@model GETAF.Models.Entities.Grupo

@{
    ViewData["Title"] = "Membros";
    Layout = "_LayoutTopMenu";
}

<link rel="stylesheet" href="~/css/Membros/Membros.css" />



<ul class="menu">
    <li><a href="#">Tarefas</a></li>
    <li><a href="#">Perguntas</a></li>
    <li><a href="#">Ranking</a></li>
    <li><a onclick="RedirecionarMembros(@Model.Id)">Membros</a></li>
    <li><a onclick="EntrarConfigGrupo(@Model.Id)">Configurações</a></li>
</ul>

<div class="invite-container">
    <button id="inviteButton" onclick="showInviteModal()">
        <span class="material-symbols-outlined">person_add</span>
    </button>
</div>

<h2>Membros - @Model.Nome</h2>
<section class="members-section">
    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Função</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><a href="#">@Model.Usuario.Nome</a></td>
                <td>Criador</td>
                <td></td>
            </tr>
        </tbody>
    </table>
</section>

<div id="deleteModal" class="modal" asp-action="DeletedConfirmed">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 class="modal-title">Confirmação de Exclusão</h2>
        <p>Tem certeza de que deseja remover <span id="memberName"></span> do grupo?</p>
        <div class="modal-buttons">
            <button class="modal-button" onclick="confirmDelete()">Excluir</button>
            <button class="modal-button" onclick="closeModal()">Cancelar</button>
        </div>
    </div>
</div>


<div id="inviteModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeInviteModal()">&times;</span>
        <h2 class="nome-grupo">@Model.Nome</h2>
        <h3 class="invite">Convite</h3>
        <p class="texto">Digite o e-mail da pessoa para enviarmos um link de convite para o seu grupo.</p>
        <input id="Email" type="email" placeholder="E-mail" required>
        <button onclick="sendInvite() asp-action="GerarLink" class="invite-send">Enviar convite</button>
        <hr>
        <p class="or">OU</p>
        <a href="#" type="button" onclick="copyLink()" class="invite-link">Copiar link</a>
    </div>
</div>


<script>
    const userMenu = document.getElementById("user-menu");

    function toggleUserMenu() {
        userMenu.classList.toggle("show");
    }

    function showModal(memberName) {
        document.getElementById("memberName").textContent = memberName;
        document.getElementById("deleteModal").style.display = "block";
    }

    function closeModal() {
        document.getElementById("deleteModal").style.display = "none";
    }

    function confirmDelete() {
        alert('O membro foi removido com sucesso!');
        closeModal();
    }

    function showInviteModal() {
        document.getElementById("inviteModal").style.display = "block";
    }

    function closeInviteModal() {
        document.getElementById("inviteModal").style.display = "none";
    }

    function sendInvite() {
        alert('Convite enviado com sucesso!');
        closeInviteModal();
    }

    function copyLink() {
        alert('Link copiado!');
    }

    function ListarMembros(grupoId) {
        $.ajax({
        url: `@Url.Action("ListarMembros", "GrupoUsuarios")?grupoId=` + grupoId,
            contentType: "application/json; charset=utf-8",
            type: "POST",
            success: function (data) {
            document.querySelector(".members-section table tbody").innerHTML += data;
            },
            error: function (jqXHR, textStatus, errorThrown) {
                alert('Algo deu errado');
            }
        });
    }

    window.onload = function () {
        ListarMembros(@Model.Id);
    };

    function EntrarConfigGrupo(grupoId) {
        window.location.href = `@Url.Action("EditarGrupo", "Grupo")?grupoId=` + grupoId;
    }
    function RedirecionarMembros(grupoId) {
        window.location.href = `@Url.Action("Membros", "GrupoUsuarios")?grupoId=` + grupoId;
    }
</script>
